//==============================================================================
//   Project   :  Hi3518
//                PLL init arm9=440M ddr=400M axi = 200M
//==============================================================================
// config PLL timeout. 4096*24M=171us
setmem /w 0x20050014 = 0x0fff8000
// config APLL
setmem /w 0x20030000 = 0x11000000
setmem /w 0x20030004 = 0x0068306E
// config VPLL
setmem /w 0x20030008 = 0x12000000
setmem /w 0x2003000c = 0x007C2063
// config BPLL
setmem /w 0x20030010 = 0x19000000
setmem /w 0x20030014 = 0x00682064
// config EPLL
setmem /w 0x20030020 = 0x1B000000
setmem /w 0x20030024 = 0x007C40E1
// config ARM9 DFS
setmem /w 0x20030028 = 0x00000010

// waiting ...
dump /w 0x0..0x200
// read 0x200300e8 == 0xf, APPL/BPLL/VPLL/EPLL Locked
dump /w 0x200300e8
dump /w 0x0..0x20

//config nand timing
setmem /w 0x10000004 = 0xaaa

// change to normal mode
setmem /w 0x20050000 = 0x214
// waiting ...
dump /w 0x0..0x200
// if 0x20050000 == 0x224, mode == normal
dump /w 0x20050000

// waiting ...
dump /w 0x0..0x200

// waiting ...
dump /w 0x0..0x200

//============================================================================== 
//   Project   :  Hi3518AV100_MDDRC 
//   DDR3 type :  128M16 1Gbit
//   DDR3 Width:  16bit 
//   Work Freq :  200 MHz
//   Work Oper :  dual_ch=0 train_mode=0 read_mode=0 wrlvl=0
//                ecc_en=0  exclu_en=1 lock_en=1 
// 
//============================================================================== 


// config DDRC configuration reg0
// [31:28]£ºinit_arefnum=0x8£»[27:20]:pd_prd=0x0£»[16]:pd_en=0x0£» 
// [13:12]£ºrank=0x0£»[10:8]£ºdram_type=0x6£»[5:4]:mem_width=0x0£»[0]:brstlen=0x0¡£
setmem /w 0x2011001c = 0x80000600

// config DDRC configuration reg1
// [22]£ºsref_zqc_en=0x0£»[10]£ºauto_pre_en=0x1£»[9]£ºwr_rcv_mode=0x1£»[8]£ºexclu_en=0x1£»
// [7]£ºlock_en=0x1£»[5]£ºwrlvl_en=0x0£»[4]£ºdual_ch=0x0£»
// [3]£ºread_mode=0x0£» [2]£ºclkratio=0x1£»[1]£ºecc_en=0x0£»[0]£ºzqc_en=0x1¡£
setmem /w 0x20110020 = 0x785

// config ddrc_timing2,disable auto refresh.
// [31:28]£ºtcke(8bit)=0x3£»[27:24]£ºtwtr=0x2£»[23:20]£ºtwr=0x4£»[17:12]£ºtfaw(8bit)=0x09£»[10:0]£ºtaref(12bit)=0x0,disable auto refresh¡£
setmem /w 0x20110058 = 0x32409000

// exit ddr3 reset 
setmem /w 0x20110010 = 0x1

// config DDRC rank configuration reg
// DDR3 128M16, [13:12]£ºmem_map=0x0£¬RBC£»[8]£ºmem_bank=0x1£¬8 bank£»[6:4]£º mem_row=0x3,14 row£»[2:0]£ºmem_col=0x2,10 col¡£
setmem /w 0x2011002c = 0x132

// config DDR memory base address
setmem /w 0x20110040 = 0x80000000

// config DDRC Timing Parameters
// ddrc_timing0
// [31:28]£ºtmrd=0x6£» [27:24]£ºtrrd=0x2£»[23:20]£ºtrp=0x3£»[19:16]£ºtrcd=0x3£»[13:8]£ºtrc(8bit)=0xa£» [4:0]£ºtras(8bit)=0x7¡£
setmem /w 0x20110050 = 0x62330a08
// ddrc_timing1
// [31:24]£ºtsre(8bit)=0xff£¬is equal to tXSDLL£»[23:20]£ºtrdlat=0x6£¬not use£»[19:16]£ºtrtw=0x2£» 
// [15:12]£ºtwl=0x6£»[11:8]£ºtcl=0x7£»[7:0]£ºtrfc(8bit)=0x21 or 0d33¡£
setmem /w 0x20110054 = 0xff626721
// ddrc_timing3
// [31:22]£ºtzq_prd=0x3ff£»[21:12]£ºtzqinit=0xff£»[11:8]£ºtaond=0x5=twl-1£»[7:4]£ºtxard=0xf£»[3:0]£ºtrtp=0x2¡£
setmem /w 0x2011005c = 0xffcff5f2

// config DDRC train mode
// train_rank=0x0, rensel=0x0, train_mode=0x0
setmem /w 0x201100ac = 0x3000001

// config DDRC ODT 
setmem /w 0x201100f4 = 0x1

// exit self-refresh, and enter normal mode
setmem /w 0x20110004 = 0x0

// wait until 0x20110000 DDRC_STATUS[in_sr]=1'b0 
dump /w 0x0..0x200
dump /w 0x0..0x200
dump /w 0x0..0x200

// Start DDRPHY Bypass initialization
// [31]£º[initbyp]=1
setmem /w 0x20120404 = 0x80000000

// wait until [idone] HIGHT£»as is Bypass initialization finished, when reading PGSR[idone]= 0x1£¨addr.:0x2012040c)¡£
dump /w 0x0..0x200
dump /w 0x0..0x200
dump /w 0x0..0x200

// config DDRC PHY setting
// PGCR:
// [24]:pddisdx=0x1£»[23:22]:zcksel=0x2£»[21:18]£ºranken=0x1£»[2]£ºDFTCMP=0x0£»[1]£ºdqscfg=0x0:active windowing mode¡£
setmem /w 0x20120408 = 0x01842202

// PTR0:
//[5:0],tDLLSRST=50ns;[17:6],tDLLLOCK=5.12us;[21:18],tITMSRST=8 clk2x period.
setmem /w 0x20120418 = 0x220055

// PTR1:
// [18:0],tDINIT0=500us;[26:19],tDINIT0=max(tRFC+10ns,5 clk2x period).
setmem /w 0x2012041c = 0x48b0d41

// PTR2:
// [16:0],tDINIT0=200us;[26:17],tDINIT0=1us.
setmem /w 0x20120420 = 0x3233881

// DSGCR:
// [0]£ºpuren=0x0¡£
setmem /w 0x2012042c = 0xf200001e

// DTPR0:
// [31]:tCCD=0x0£»[30:25]£ºtRC=0x14£»[24:21]£ºtRRD=0x4£»[20:16]£ºtRAS=0xf
// [15:12]£ºtRCD=0x6£»[11:8]£ºtRP=0x6£»[7:5]£ºtWTR=0x4£»[4:2]:tRTP=0x4£»[1:0]£ºtMRD=0x3.
setmem /w 0x20120434 = 0x288f6693

// DTPR1:
// [29:27]£ºtDQSCKmax=0x(only for LPDDR2),not use£»[26:24]£ºtDQSCK=0(only for LPDDR2), not use£»
// [23:16]£ºtRFC=0x41 or 65,is equal to tRFC£»
// [11]£ºtRTODT=0£»[10:9]£ºtMOD=0x0£»[8:3]£ºtFAW=0x11£»
// [2]£ºtRTW=0x0,add 1 clock to standard bus turn aroud delay£»[1:0]£ºtAOND/tAOFD=0x3£»
setmem /w 0x20120438 = 0x0041008b

// DTPR2:
// [28:19]£ºtDLLK=0x200 or 512£»[18:15]£ºtCKE=0x3£»
// [14:10]£ºtXP=0xa£»[9:0]£ºtXS=0x200 ,or 512£»
setmem /w 0x2012043c = 0x1001aa00

// DDRC_PUB_ZQNCR1
// [7:4]    zprog.odt=0x6
// [3:0]    zprog.drv=0xd:34
setmem /w 0x20120584 = 0x6d
// MR0:
// [12]:PD=0x1,fast exit£»[11:9]:WR=0x3, 7 CK period£»[8]:DR=0x1;
// [6:4,2]:CL=0x6, 7 CK period.
setmem /w 0x20120440 = 0x1730
// MR1:
// [9,6,2]:Rtt_nom=0x1£¬60 Ohm£»[5,1]:ODIC=0x1,34 Ohm.
setmem /w 0x20120444 = 0x6
// MR2:
// [5:3]: CWL=0x1,twl=6¡£
setmem /w 0x20120448 = 0x8

// DX0GCR:
// [12:11]:RTTOH=0x1£»[10]£ºDQRTT=0x1£»[9]£ºDQSRTT=0x1£»
// [8:7]£ºDSEN=0x1£»[0]£ºDXEN=0x1¡£
setmem /w 0x201205c0 = 0xe81
// DX1GCR:
setmem /w 0x20120600 = 0xe81

// Start DDRPHY normal initialization
// [7:0]£º[qstrn]=1£¬[draminit]=1£¬[dramrst]=1£¬[itmsrst]=1£¬[zcal]=1£¬[dlllock]=1£¬[dllsrst]=1,[init]=1
setmem /w 0x20120404 = 0xff

// initialization finished, when reading 0x2012040c PGSR[idone]= 0x1; 

// period=5.000000, period_ddr=2.500000

// ddrc_timing2:
// [10:0]£ºtaref(12bit)=0x62,enable auto refresh¡£
setmem /w 0x20110058 = 0x32409062
setmem /w 0x20120408 = 0x01842200

